#include <stdio.h>

#include "generated/C/sha256.c"

int main(int argc, char **argv)
    {
    // test vectors taken from OpenSSL tests/sha256t.c
    unsigned char m1[64] = { 0x61U, 0x62U, 0x63U };
    unsigned char h1[32] = {
	0xba,0x78,0x16,0xbf,0x8f,0x01,0xcf,0xea,
	0x41,0x41,0x40,0xde,0x5d,0xae,0x22,0x23,
	0xb0,0x03,0x61,0xa3,0x96,0x17,0x7a,0x9c,
	0xb4,0x10,0xff,0x61,0xf2,0x00,0x15,0xad	};
    unsigned char out[32];
    unsigned n;

    sha256(out, m1, 24);

    for(n = 0 ; n < 32 ; ++n)
	{
	printf("%02x", out[n]);
	if(out[n] == h1[n])
	    putchar(' ');
	else
	    putchar('*');
	}

    putchar('\n');

    return 0;
    }

